{% extends "layout.html" %}
{% block content %}
<div class="mx-auto max-w-7xl">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
        <div>
            <h1 class="text-2xl font-semibold text-slate-800">
                <i class="fa-solid fa-calendar-check mr-2"></i> Proof Submission Window
            </h1>
            <p class="text-slate-600 text-sm">Configure declaration/proof windows with reminders.</p>
        </div>
        <div class="flex items-center gap-2">
            <button id="btnNewWindow" class="px-3 py-2 rounded-xl bg-slate-800 text-white hover:bg-slate-900 text-sm">
                <i class="fa-solid fa-plus mr-1"></i> New Window
            </button>
            <button id="btnNewReminder"
                class="px-3 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 text-sm">
                <i class="fa-solid fa-bell mr-1"></i> New Reminder
            </button>
            <button id="btnExport"
                class="px-3 py-2 rounded-xl border border-slate-300 bg-white hover:bg-slate-50 text-sm">
                <i class="fa-solid fa-file-arrow-down mr-1"></i> Export
            </button>
            <a href="{{ url_for('dashboard') }}"
                class="px-3 py-2 rounded-xl border border-slate-300 bg-white hover:bg-slate-50 text-sm">
                <i class="fa-solid fa-arrow-left mr-1"></i> Back
            </a>
        </div>
    </div>

    <!-- Tabs -->
    <div class="mb-6">
        <div class="flex space-x-1 bg-slate-100 p-1 rounded-xl">
            <button id="overviewTab" class="psw-tab active px-4 py-2 rounded-lg text-sm font-medium"><i
                    class="fa-solid fa-gauge-high mr-1"></i> Overview</button>
            <button id="windowsTab" class="psw-tab px-4 py-2 rounded-lg text-sm font-medium"><i
                    class="fa-solid fa-calendar-days mr-1"></i> Windows</button>
            <button id="remindersTab" class="psw-tab px-4 py-2 rounded-lg text-sm font-medium"><i
                    class="fa-solid fa-bell mr-1"></i> Reminders</button>
            <button id="historyTab" class="psw-tab px-4 py-2 rounded-lg text-sm font-medium"><i
                    class="fa-solid fa-clock-rotate-left mr-1"></i> History</button>
            <button id="settingsTab" class="psw-tab px-4 py-2 rounded-lg text-sm font-medium"><i
                    class="fa-solid fa-gear mr-1"></i> Settings</button>
        </div>
    </div>

    <!-- Overview -->
    <section id="overviewPanel" class="psw-panel">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- KPIs -->
            <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-lg font-semibold text-slate-800"><i class="fa-solid fa-clipboard-list mr-2"></i>
                        Current FY</h3>
                    <span id="fyBadge" class="px-2 py-1 text-xs rounded bg-amber-50 text-amber-700">Draft</span>
                </div>
                <div class="grid grid-cols-4 gap-3">
                    <div class="rounded-lg bg-slate-50 p-3">
                        <div class="text-xs text-slate-500">Windows</div>
                        <div id="kpiWindows" class="text-xl font-semibold text-slate-800">0</div>
                    </div>
                    <div class="rounded-lg bg-slate-50 p-3">
                        <div class="text-xs text-slate-500">Active Now</div>
                        <div id="kpiActive" class="text-xl font-semibold text-slate-800">0</div>
                    </div>
                    <div class="rounded-lg bg-slate-50 p-3">
                        <div class="text-xs text-slate-500">Upcoming</div>
                        <div id="kpiUpcoming" class="text-xl font-semibold text-slate-800">0</div>
                    </div>
                    <div class="rounded-lg bg-slate-50 p-3">
                        <div class="text-xs text-slate-500">Reminders</div>
                        <div id="kpiRem" class="text-xl font-semibold text-slate-800">0</div>
                    </div>
                </div>
                <div class="relative h-40 mt-4"><canvas id="kpiChart" class="absolute inset-0 w-full h-full"></canvas>
                </div>
                <div class="mt-4 flex items-center gap-2">
                    <select id="fyPicker" class="px-2 py-1 rounded-lg border border-slate-300 text-sm">
                        <option>FY 2025–26</option>
                        <option>FY 2024–25</option>
                        <option>FY 2023–24</option>
                    </select>
                    <button id="btnValidate"
                        class="px-3 py-2 rounded-lg border border-slate-300 bg-white text-sm hover:bg-slate-50">
                        <i class="fa-solid fa-spell-check mr-1"></i> Validate
                    </button>
                </div>
            </div>

            <!-- Mix -->
            <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-lg font-semibold text-slate-800"><i class="fa-solid fa-chart-pie mr-2"></i> Status
                        Mix</h3>
                </div>
                <div class="relative h-40"><canvas id="mixChart" class="absolute inset-0 w-full h-full"></canvas></div>
                <div id="mixLegend" class="mt-3 text-sm text-slate-700"></div>
            </div>

            <!-- Quick Actions -->
            <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <h3 class="text-lg font-semibold text-slate-800 mb-3"><i class="fa-solid fa-bolt mr-2"></i> Quick
                    Actions</h3>
                <div class="space-y-3">
                    <button id="btnPreview"
                        class="w-full px-4 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-left"><i
                            class="fa-solid fa-eye mr-2"></i> Preview employee timeline</button>
                    <button id="btnNudge"
                        class="w-full px-4 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-left"><i
                            class="fa-solid fa-bell mr-2"></i> Send test reminder</button>
                    <button id="btnRollback"
                        class="w-full px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-left"><i
                            class="fa-solid fa-rotate-left mr-2"></i> Rollback last change</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Windows -->
    <section id="windowsPanel" class="psw-panel hidden">
        <div class="rounded-2xl border border-slate-200 bg-white p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-slate-800"><i class="fa-solid fa-calendar-days mr-2"></i>
                    Declaration & Proof Windows</h3>
                <div class="flex items-center gap-2">
                    <input id="winSearch" type="text" placeholder="Search type or FY..."
                        class="px-3 py-2 rounded-xl border border-slate-300 bg-white text-sm">
                    <select id="winStatus" class="px-3 py-2 rounded-xl border border-slate-300 bg-white text-sm">
                        <option value="all">All</option>
                        <option value="active">Active</option>
                        <option value="closed">Closed</option>
                        <option value="upcoming">Upcoming</option>
                    </select>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="text-left text-slate-500 border-b">
                        <tr>
                            <th class="py-2 pr-4">Type</th>
                            <th class="py-2 pr-4">FY</th>
                            <th class="py-2 pr-4">Open</th>
                            <th class="py-2 pr-4">Close</th>
                            <th class="py-2 pr-4">Grace (days)</th>
                            <th class="py-2 pr-4">Status</th>
                            <th class="py-2 pr-4">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="winRows" class="text-slate-800"></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Reminders -->
    <section id="remindersPanel" class="psw-panel hidden">
        <div class="rounded-2xl border border-slate-200 bg-white p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-slate-800"><i class="fa-solid fa-bell mr-2"></i> Reminders</h3>
                <div class="flex items-center gap-2">
                    <input id="remSearch" type="text" placeholder="Search window or channel..."
                        class="px-3 py-2 rounded-xl border border-slate-300 bg-white text-sm">
                    <select id="remScope" class="px-3 py-2 rounded-xl border border-slate-300 bg-white text-sm">
                        <option value="all">All</option>
                        <option value="declaration">Declaration</option>
                        <option value="proof">Proof</option>
                    </select>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="text-left text-slate-500 border-b">
                        <tr>
                            <th class="py-2 pr-4">Window</th>
                            <th class="py-2 pr-4">When</th>
                            <th class="py-2 pr-4">Channel</th>
                            <th class="py-2 pr-4">Audience</th>
                            <th class="py-2 pr-4">Template</th>
                            <th class="py-2 pr-4">Status</th>
                            <th class="py-2 pr-4">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="remRows" class="text-slate-800"></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- History -->
    <section id="historyPanel" class="psw-panel hidden">
        <div class="rounded-2xl border border-slate-200 bg-white p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-slate-800"><i class="fa-solid fa-table mr-2"></i> Change History
                </h3>
                <div class="text-sm text-slate-600">Last 10 edits</div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="text-left text-slate-500 border-b">
                        <tr>
                            <th class="py-2 pr-4">Time</th>
                            <th class="py-2 pr-4">Entity</th>
                            <th class="py-2 pr-4">Name</th>
                            <th class="py-2 pr-4">Action</th>
                            <th class="py-2 pr-4">By</th>
                        </tr>
                    </thead>
                    <tbody id="histRows" class="text-slate-800"></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Settings -->
    <section id="settingsPanel" class="psw-panel hidden">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <h3 class="text-lg font-semibold text-slate-800 mb-4"><i class="fa-solid fa-clock mr-2"></i> Defaults
                </h3>
                <div class="space-y-2 text-sm">
                    <label class="block">Default grace days<input id="stGrace" type="number" min="0" value="3"
                            class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2"></label>
                    <label class="flex items-center gap-2"><input id="stLock" type="checkbox"> Lock claims after
                        close</label>
                </div>
            </div>
            <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <h3 class="text-lg font-semibold text-slate-800 mb-4"><i class="fa-solid fa-bell mr-2"></i> Reminder
                    Rules</h3>
                <div class="space-y-2 text-sm">
                    <label class="flex items-center gap-2"><input id="stDigest" type="checkbox" checked> Daily digest
                        during last 3 days</label>
                    <label class="flex items-center gap-2"><input id="stSkipWKND" type="checkbox" checked> Skip
                        weekends</label>
                </div>
            </div>
            <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <h3 class="text-lg font-semibold text-slate-800 mb-4"><i class="fa-solid fa-floppy-disk mr-2"></i> Save
                </h3>
                <button id="stSave"
                    class="px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-sm">
                    <i class="fa-solid fa-floppy-disk mr-1"></i> Save
                </button>
            </div>
        </div>
    </section>
</div>

<!-- Modal -->
<div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="fixed inset-0 overflow-y-auto">
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg">
                <div class="p-6 border-b border-slate-200 flex items-center justify-between">
                    <h3 id="modalTitle" class="text-lg font-semibold text-slate-800">New</h3>
                    <button id="closeModal" class="text-slate-400 hover:text-slate-600"><i
                            class="fa-solid fa-times text-xl"></i></button>
                </div>
                <div id="modalBody" class="p-6 space-y-4 text-sm"></div>
                <div class="px-6 pb-6 flex items-center justify-end gap-2">
                    <button id="cancelEdit"
                        class="px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50">Cancel</button>
                    <button id="saveEdit" class="px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"><i
                            class="fa-solid fa-check mr-1"></i> Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

<script>
    // ----  Data ----
    const WINDOWS = [
        { id: 1, type: 'Declaration', fy: 'FY 2025–26', open: '2025-04-01', close: '2025-05-15', grace: 3, status: 'closed' },
        { id: 2, type: 'Proof', fy: 'FY 2024–25', open: '2025-01-10', close: '2025-02-10', grace: 5, status: 'closed' },
        { id: 3, type: 'Proof', fy: 'FY 2025–26', open: '2025-12-05', close: '2026-01-10', grace: 3, status: 'upcoming' },
        { id: 4, type: 'Declaration', fy: 'FY 2026–27', open: '2026-04-01', close: '2026-05-10', grace: 2, status: 'upcoming' }
    ];
    const REMINDERS = [
        { id: 11, window: 'Declaration — FY 2025–26', when: 'Open+1d', channel: 'Email', audience: 'All', tmpl: 'DEC_OPEN', status: 'active' },
        { id: 12, window: 'Proof — FY 2024–25', when: '7d before close', channel: 'Slack', audience: 'Pending', tmpl: 'PRF_NUDGE', status: 'active' },
        { id: 13, window: 'Proof — FY 2025–26', when: '1d before close', channel: 'SMS', audience: 'Pending', tmpl: 'PRF_LAST', status: 'inactive' }
    ];
    const HISTORY = [
        { ts: '2025-09-10 18:30', ent: 'Window', name: 'Proof FY25–26', action: 'Created', by: 'Payroll' },
        { ts: '2025-08-22 09:10', ent: 'Reminder', name: 'PRF_NUDGE', action: 'Enabled', by: 'System' },
        { ts: '2025-05-16 19:00', ent: 'Window', name: 'Decl FY25–26', action: 'Auto-closed', by: 'System' }
    ];

    // ---- Panels/Tabs ----
    const panels = {
        overview: document.getElementById('overviewPanel'),
        windows: document.getElementById('windowsPanel'),
        reminders: document.getElementById('remindersPanel'),
        history: document.getElementById('historyPanel'),
        settings: document.getElementById('settingsPanel')
    };
    let _kpiChart, _mixChart;

    document.addEventListener('DOMContentLoaded', () => {
        setupTabs();
        wireButtons();
        renderKPIs();
        drawCharts();
        renderWindows();
        renderReminders();
        renderHistory();
    });

    function setupTabs() {
        document.querySelectorAll('.psw-tab').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.psw-tab').forEach(b => b.classList.remove('active'));
                e.currentTarget.classList.add('active');
                const name = e.currentTarget.id.replace('Tab', '');
                Object.values(panels).forEach(p => p.classList.add('hidden'));
                panels[name].classList.remove('hidden');
            });
        });
    }

    function wireButtons() {
        document.getElementById('btnNewWindow').addEventListener('click', () => openModal('New Window', windowForm()));
        document.getElementById('btnNewReminder').addEventListener('click', () => openModal('New Reminder', reminderForm()));
        document.getElementById('btnExport').addEventListener('click', () => alert('✅ Exported ()'));
        document.getElementById('btnValidate').addEventListener('click', () => alert('✅ Validation passed ()'));
        document.getElementById('btnPreview').addEventListener('click', () => alert('👀 Timeline previewed ()'));
        document.getElementById('btnNudge').addEventListener('click', () => alert('🔔 Test reminder sent ()'));
        document.getElementById('btnRollback').addEventListener('click', () => alert('↩️ Rolled back ()'));
        document.getElementById('stSave').addEventListener('click', () => alert('✅ Settings saved'));

        document.getElementById('winSearch').addEventListener('input', renderWindows);
        document.getElementById('winStatus').addEventListener('change', renderWindows);
        document.getElementById('remSearch').addEventListener('input', renderReminders);
        document.getElementById('remScope').addEventListener('change', renderReminders);

        document.getElementById('closeModal').addEventListener('click', closeModal);
        document.getElementById('cancelEdit').addEventListener('click', closeModal);
        document.getElementById('saveEdit').addEventListener('click', () => { closeModal(); alert('💾 Saved ()'); });
    }

    // ---- Overview/KPIs ----
    function renderKPIs() {
        const now = new Date('2025-09-16T12:00:00+05:30'); //  now (IST)
        const active = WINDOWS.filter(w => new Date(w.open) <= now && now <= new Date(w.close)).length;
        const upcoming = WINDOWS.filter(w => new Date(w.open) > now).length;
        document.getElementById('kpiWindows').textContent = WINDOWS.length;
        document.getElementById('kpiActive').textContent = active;
        document.getElementById('kpiUpcoming').textContent = upcoming;
        document.getElementById('kpiRem').textContent = REMINDERS.length;

        const badge = document.getElementById('fyBadge');
        const ready = WINDOWS.length > 0 && REMINDERS.length > 0;
        badge.textContent = ready ? 'Ready' : (WINDOWS.length > 0 ? 'In Progress' : 'Draft');
        badge.className = 'px-2 py-1 text-xs rounded ' + (ready ? 'bg-emerald-50 text-emerald-700' : (WINDOWS.length > 0 ? 'bg-amber-50 text-amber-700' : 'bg-slate-100 text-slate-700'));
    }

    function drawCharts() {
        const ctx1 = document.getElementById('kpiChart').getContext('2d');
        if (_kpiChart) _kpiChart.destroy();
        _kpiChart = new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: ['Windows', 'Active', 'Upcoming', 'Reminders'],
                datasets: [{
                    label: 'Count', data: [
                        WINDOWS.length,
                        Number(document.getElementById('kpiActive').textContent) || 0,
                        Number(document.getElementById('kpiUpcoming').textContent) || 0,
                        REMINDERS.length
                    ]
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, animation: false, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } } }
        });

        const counts = {
            active: WINDOWS.filter(w => w.status === 'active').length,
            upcoming: WINDOWS.filter(w => w.status === 'upcoming').length,
            closed: WINDOWS.filter(w => w.status === 'closed').length
        };
        const ctx2 = document.getElementById('mixChart').getContext('2d');
        if (_mixChart) _mixChart.destroy();
        _mixChart = new Chart(ctx2, {
            type: 'doughnut',
            data: { labels: Object.keys(counts), datasets: [{ data: Object.values(counts) }] },
            options: { responsive: true, maintainAspectRatio: false, cutout: '65%', plugins: { legend: { display: false } }, animation: false }
        });
        document.getElementById('mixLegend').innerHTML =
            Object.entries(counts).map(([k, v]) => `<div class="flex items-center justify-between text-sm"><span class="capitalize">${k}</span><span>${v}</span></div>`).join('');
    }

    // ---- Windows ----
    function renderWindows() {
        const q = (document.getElementById('winSearch').value || '').toLowerCase();
        const st = document.getElementById('winStatus').value;
        const rows = WINDOWS
            .map(w => ({ ...w, status: inferStatus(w) }))
            .filter(r => (st === 'all' ? true : r.status === st))
            .filter(r => r.type.toLowerCase().includes(q) || r.fy.toLowerCase().includes(q))
            .slice().sort((a, b) => new Date(a.open) - new Date(b.open));
        document.getElementById('winRows').innerHTML = rows.map(rowWindow).join('') || emptyRow(7);
    }
    function rowWindow(r) {
        return `<tr class="border-b last:border-0">
    <td class="py-2 pr-4">${r.type}</td>
    <td class="py-2 pr-4">${r.fy}</td>
    <td class="py-2 pr-4">${r.open}</td>
    <td class="py-2 pr-4">${r.close}</td>
    <td class="py-2 pr-4">${r.grace}</td>
    <td class="py-2 pr-4">${badgeStatus(r.status)}</td>
    <td class="py-2 pr-4">
      <button class="px-2 py-1 rounded border border-slate-300 bg-white text-xs hover:bg-slate-50" onclick="alert('✏️ Edit ${r.type} ${r.fy} ()')"><i class="fa-solid fa-pen mr-1"></i> Edit</button>
    </td>
  </tr>`;
    }
    function inferStatus(w) {
        const now = new Date('2025-09-16T12:00:00+05:30'); //  now
        if (new Date(w.close) < now) return 'closed';
        if (new Date(w.open) > now) return 'upcoming';
        return 'active';
    }

    // ---- Reminders ----
    function renderReminders() {
        const q = (document.getElementById('remSearch').value || '').toLowerCase();
        const scope = document.getElementById('remScope').value;
        const rows = REMINDERS
            .filter(r => scope === 'all' ? true : r.window.toLowerCase().startsWith(scope))
            .filter(r => r.window.toLowerCase().includes(q) || r.channel.toLowerCase().includes(q))
            .slice().sort((a, b) => a.window.localeCompare(b.window));
        document.getElementById('remRows').innerHTML = rows.map(rowReminder).join('') || emptyRow(7);
    }
    function rowReminder(r) {
        return `<tr class="border-b last:border-0">
    <td class="py-2 pr-4">${r.window}</td>
    <td class="py-2 pr-4">${r.when}</td>
    <td class="py-2 pr-4">${r.channel}</td>
    <td class="py-2 pr-4">${r.audience}</td>
    <td class="py-2 pr-4"><span class="px-2 py-0.5 rounded bg-slate-50 text-slate-700 text-xs">${r.tmpl}</span></td>
    <td class="py-2 pr-4">${badgeStatus(r.status)}</td>
    <td class="py-2 pr-4">
      <button class="px-2 py-1 rounded border border-slate-300 bg-white text-xs hover:bg-slate-50" onclick="alert('✏️ Edit ${r.tmpl} ()')"><i class="fa-solid fa-pen mr-1"></i> Edit</button>
    </td>
  </tr>`;
    }

    // ---- History ----
    function renderHistory() {
        document.getElementById('histRows').innerHTML = HISTORY.map(h => `
    <tr class="border-b last:border-0">
      <td class="py-2 pr-4 text-slate-600">${h.ts}</td>
      <td class="py-2 pr-4">${h.ent}</td>
      <td class="py-2 pr-4">${h.name}</td>
      <td class="py-2 pr-4">${h.action}</td>
      <td class="py-2 pr-4">${h.by}</td>
    </tr>`).join('');
    }

    // ---- Modal helpers ----
    function openModal(title, bodyHTML) {
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalBody').innerHTML = bodyHTML;
        document.getElementById('editModal').classList.remove('hidden');
    }
    function closeModal() { document.getElementById('editModal').classList.add('hidden'); }

    function windowForm() {
        return `
    <label class="block">Type
      <select class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2">
        <option>Declaration</option><option>Proof</option>
      </select>
    </label>
    <label class="block mt-2">FY
      <input class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2" placeholder="FY 2025–26">
    </label>
    <div class="grid grid-cols-2 gap-3 mt-2">
      <label class="block">Open<input type="date" class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2"></label>
      <label class="block">Close<input type="date" class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2"></label>
    </div>
    <label class="block mt-2">Grace days<input type="number" min="0" value="3" class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2"></label>
    <div class="mt-2"><label class="flex items-center gap-2"><input type="checkbox" checked> Active</label></div>`;
    }
    function reminderForm() {
        return `
    <label class="block">Window
      <input class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2" placeholder="Declaration — FY 2025–26">
    </label>
    <label class="block mt-2">When
      <select class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2">
        <option>Open+1d</option><option>7d before close</option><option>1d before close</option>
      </select>
    </label>
    <div class="grid grid-cols-2 gap-3 mt-2">
      <label class="block">Channel
        <select class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2">
          <option>Email</option><option>Slack</option><option>SMS</option>
        </select>
      </label>
      <label class="block">Audience
        <select class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2">
          <option>All</option><option>Pending</option>
        </select>
      </label>
    </div>
    <label class="block mt-2">Template code
      <input class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2" placeholder="DEC_OPEN">
    </label>
    <div class="mt-2"><label class="flex items-center gap-2"><input type="checkbox" checked> Active</label></div>`;
    }

    // ---- Utils ----
    function badgeStatus(s) {
        const map = { active: 'bg-emerald-50 text-emerald-700', upcoming: 'bg-blue-50 text-blue-700', closed: 'bg-slate-100 text-slate-700', inactive: 'bg-slate-100 text-slate-700' };
        const label = s.charAt(0).toUpperCase() + s.slice(1);
        return `<span class="px-2 py-0.5 rounded-full ${map[s] || map['inactive']} text-xs">${label}</span>`;
    }
    function emptyRow(colspan) { return `<tr><td colspan="${colspan}" class="py-6 text-center text-slate-500">No records.</td></tr>`; }
</script>

<style>
    .psw-tab.active {
        background-color: #1e293b;
        color: #fff;
    }

    .psw-tab:not(.active) {
        color: #64748b;
    }

    .psw-tab:not(.active):hover {
        background-color: #f1f5f9;
        color: #334155;
    }
</style>
{% endblock %}